\begin{Verbatim}[commandchars=@\[\]]
@PYay[class] @PYaN[Array]
  alias_method @PYat[:old_index], @PYat[:index]

  @PYay[def] @PYaK[index](obj @PYbe[=] @PYaj[nil])
    @PYay[if] obj@PYbe[.]nil?
      @PYaX[self]@PYbe[.]each_with_index @PYay[do] @PYbe[|]e, i@PYbe[|]
        @PYay[return] i @PYay[if] @PYay[yield] e
      @PYay[end]
      @PYaj[nil]
    @PYay[else]
      old_index(obj)
    @PYay[end]
  @PYay[end]
@PYay[end]
\end{Verbatim}
